# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ #
#				Vars                                                                                                        #
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ #

NAME			:= philo
PRINT_NAME		:= philo

CC 				:= gcc
CFLAGS			:= -Wall -Wextra -Werror

THREAD			:= -lpthread

INCLUDES_DIR	:= ./includes/
SOURCES_DIR		:= ./sources/

PRINT_PREFIX	:= \033[1m\033[38;5;240m[\033[0m\033[38;5;250m$(PRINT_NAME)\033[1m\033[38;5;240m] \033[38;5;105m~\033[0m
T 				:= 1

SIZE_TERM		:= $(shell tput cols)
NEG				:= $(shell echo $$((($(SIZE_TERM)-7)/2)))
HEAD			:= $(shell printf "%$(NEG)s" | tr " " "━")

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ #
#				Files																										#
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ #

SRCS			=	main.c						parsing.c					thread.c					philos.c			\
					fork.c																									\

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ #
#				Rules																										#
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ #

all:			 title $(NAME)
	@:
	@echo "$(PRINT_PREFIX)\033[0;38;5;190m Done !\033[0m\n"

$(NAME):
	@$(foreach s,$(SRCS),echo "$(PRINT_PREFIX) Compiling \033[0;33m$(s)\033[0m";)
	@$(CC) $(CFLAGS) $(addprefix $(SOURCES_DIR), $(SRCS)) -I $(INCLUDES_DIR) $(THREAD) -o $(NAME)

clean:			title
	@echo "$(PRINT_PREFIX)\033[0;38;5;226m Cleaning \033[0m\n"
	@rm -f $(NAME)


fclean:			clean

re: 			fclean all

bonus:			all

.PHONY:			all

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ #
#				Style                                                                                                       #
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ #

title:
ifeq ($(T), 1)
	$(call title,$(PRINT_NAME))
	@T=0
endif

define title
	@echo "\033[38;5;240m$(HEAD)\033[0m $(1) \033[38;5;240m$(HEAD)\033[0m\n";
endef
